import{d as L,l as $,f as H,A as O,m as g,p as F,r as q,c as l,o as u,a as e,k as p,b as A,e as S,n as G,u as i,t as a,s as J,v as _,C as k,x as T,w as K,F as Q,h as W}from"./index-DeSzD2_9.js";import{u as X}from"./transactions-DTEC-O-J.js";import{r as Y}from"./ArrowPathIcon-wKmh79yy.js";import{r as j}from"./ArrowsRightLeftIcon-BMzKj2fu.js";const Z={class:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ee={class:"card mb-8"},te={class:"flex items-center justify-between mb-4"},se=["disabled"],oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ne={class:"text-center p-4 bg-blue-50 rounded-lg"},ae={class:"text-blue-700"},re={class:"text-center p-4 bg-green-50 rounded-lg"},le={class:"text-green-700"},ue={class:"card"},ie={class:"mb-6"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},me={class:"relative"},ce=["max","disabled"],ve={class:"absolute inset-y-0 right-0 pr-3 flex items-center"},fe={class:"text-gray-500 text-sm font-medium"},pe={class:"mt-2 flex justify-between text-sm text-gray-600"},xe={class:"flex justify-center mb-6"},ye={class:"mb-6"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge={class:"relative"},Ae=["disabled"],_e={class:"absolute inset-y-0 right-0 pr-3 flex items-center"},Ce={class:"text-gray-500 text-sm font-medium"},he={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg"},Se={class:"text-sm text-gray-700 space-y-1"},De={class:"flex justify-between"},Re={class:"font-medium"},we={class:"flex justify-between"},Ue={class:"font-medium"},Fe={class:"flex justify-between border-t border-gray-200 pt-1 mt-2"},ke={class:"font-medium"},Te={class:"mb-6 p-4 bg-blue-50 rounded-lg"},je={class:"grid grid-cols-2 gap-4 text-sm"},Ee={class:"font-medium ml-2 text-blue-900"},Ie={class:"font-medium ml-2 text-blue-900"},Pe={class:"flex justify-end space-x-4"},Ve=["disabled"],Me={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Ne={key:0,class:"mt-8"},ze={class:"card"},Be={class:"space-y-3"},Le={class:"flex items-center space-x-3"},$e={class:"w-8 h-8 bg-warning-100 rounded-full flex items-center justify-center"},He={class:"text-xs text-gray-600"},Oe={class:"text-right"},qe={key:0,class:"text-sm font-medium text-gray-900"},Ge={key:1,class:"text-sm font-medium text-gray-900"},Ye=L({__name:"ExchangeView",setup(Je){const E=$(),c=H(),v=X(),I=O(),d=g(!1),x=g(!1),s=g({fromCurrency:"ARS",toCurrency:"USD",fromAmount:"",toAmount:""}),r=g(1e3),D=F(()=>v.transactions.filter(o=>o.transaccionesTipoId===4)),R=o=>{var t,m;return o==="ARS"?((t=c.user)==null?void 0:t.userPesos)||0:o==="USD"&&((m=c.user)==null?void 0:m.userDolares)||0},C=o=>R(o),w=F(()=>{const o=parseFloat(s.value.fromAmount)||0;return o>0&&o<=C(s.value.fromCurrency)}),f=(o,t)=>new Intl.NumberFormat("es-AR",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(o),U=()=>{const o=parseFloat(s.value.fromAmount)||0;if(o===0){s.value.toAmount="";return}s.value.fromCurrency==="ARS"&&s.value.toCurrency==="USD"?s.value.toAmount=(o/r.value).toFixed(2):s.value.fromCurrency==="USD"&&s.value.toCurrency==="ARS"&&(s.value.toAmount=(o*r.value).toFixed(2))},P=()=>{const o=parseFloat(s.value.toAmount)||0;if(o===0){s.value.fromAmount="";return}s.value.fromCurrency==="ARS"&&s.value.toCurrency==="USD"?s.value.fromAmount=(o*r.value).toFixed(2):s.value.fromCurrency==="USD"&&s.value.toCurrency==="ARS"&&(s.value.fromAmount=(o/r.value).toFixed(2))},V=()=>{const o=s.value.fromCurrency;s.value.fromCurrency=s.value.toCurrency,s.value.toCurrency=o,y()},y=()=>{s.value.fromAmount="",s.value.toAmount=""},M=()=>{const o=C(s.value.fromCurrency);s.value.fromAmount=o.toString(),U()},N=()=>s.value.fromCurrency==="ARS"&&s.value.toCurrency==="USD"?`1 ARS = ${(1/r.value).toFixed(4)} USD`:s.value.fromCurrency==="USD"&&s.value.toCurrency==="ARS"?`1 USD = ${r.value} ARS`:"",z=async()=>{x.value=!0,setTimeout(()=>{r.value=1e3+Math.random()*50-25,x.value=!1},1e3)},B=async()=>{var o;if(w.value)try{d.value=!0;const t=parseFloat(s.value.fromAmount),m=parseFloat(s.value.toAmount),b={transaccionesUsuarioId:((o=c.user)==null?void 0:o.userId)||"",transaccionesPesos:s.value.fromCurrency==="ARS"?-t:m,transaccionesDolares:s.value.fromCurrency==="USD"?-t:m,transaccionesTipoId:4,transaccionesFecha:new Date().toISOString()};await v.createTransaction(b)&&(I.success("Cambio de moneda realizado exitosamente"),y(),E.push("/transactions"))}catch(t){console.error("Exchange error:",t)}finally{d.value=!1}};return(o,t)=>{var b,h;const m=q("router-link");return u(),l("div",Z,[t[22]||(t[22]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Cambio de Moneda"),e("p",{class:"text-gray-600"}," Convierte entre pesos argentinos y d贸lares estadounidenses al tipo de cambio actual ")],-1)),e("div",ee,[e("div",te,[t[5]||(t[5]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Tipo de Cambio Actual",-1)),e("button",{onClick:z,disabled:x.value,class:"btn-secondary text-sm"},[A(i(Y),{class:G(["w-4 h-4 mr-2",{"animate-spin":x.value}])},null,8,["class"]),t[4]||(t[4]=S(" Actualizar ",-1))],8,se)]),e("div",oe,[e("div",ne,[t[6]||(t[6]=e("div",{class:"text-2xl font-bold text-blue-900"},"1 USD",-1)),e("div",ae,"= "+a(r.value)+" ARS",1)]),e("div",re,[t[7]||(t[7]=e("div",{class:"text-2xl font-bold text-green-900"},"1 ARS",-1)),e("div",le,"= "+a((1/r.value).toFixed(4))+" USD",1)])])]),e("div",ue,[e("form",{onSubmit:J(B,["prevent"])},[e("div",ie,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Convertir desde ",-1)),e("div",de,[e("div",null,[_(e("select",{"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.fromCurrency=n),class:"input-field",onChange:y},[...t[8]||(t[8]=[e("option",{value:"ARS"},"Pesos Argentinos (ARS)",-1),e("option",{value:"USD"},"D贸lares Estadounidenses (USD)",-1)])],544),[[k,s.value.fromCurrency]])]),e("div",null,[e("div",me,[_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>s.value.fromAmount=n),type:"number",step:"0.01",min:"0",max:C(s.value.fromCurrency),class:"input-field pr-16",placeholder:"0.00",onInput:U,disabled:d.value},null,40,ce),[[T,s.value.fromAmount]]),e("div",ve,[e("span",fe,a(s.value.fromCurrency),1)])])])]),e("div",pe,[e("span",null,"Disponible: "+a(f(R(s.value.fromCurrency),s.value.fromCurrency)),1),e("button",{type:"button",onClick:M,class:"text-primary-600 hover:text-primary-700 font-medium"}," Usar todo ")])]),e("div",xe,[e("button",{type:"button",onClick:V,class:"w-12 h-12 bg-primary-100 hover:bg-primary-200 rounded-full flex items-center justify-center transition-colors"},[A(i(j),{class:"w-6 h-6 text-primary-600"})])]),e("div",ye,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Convertir a ",-1)),e("div",be,[e("div",null,[_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>s.value.toCurrency=n),class:"input-field",onChange:y},[...t[10]||(t[10]=[e("option",{value:"USD"},"D贸lares Estadounidenses (USD)",-1),e("option",{value:"ARS"},"Pesos Argentinos (ARS)",-1)])],544),[[k,s.value.toCurrency]])]),e("div",null,[e("div",ge,[_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>s.value.toAmount=n),type:"number",step:"0.01",min:"0",class:"input-field pr-16",placeholder:"0.00",onInput:P,disabled:d.value},null,40,Ae),[[T,s.value.toAmount]]),e("div",_e,[e("span",Ce,a(s.value.toCurrency),1)])])])])]),s.value.fromAmount&&s.value.toAmount?(u(),l("div",he,[t[15]||(t[15]=e("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"Resumen del cambio",-1)),e("div",Se,[e("div",De,[t[12]||(t[12]=e("span",null,"Convertir:",-1)),e("span",Re,a(f(parseFloat(s.value.fromAmount),s.value.fromCurrency)),1)]),e("div",we,[t[13]||(t[13]=e("span",null,"Recibir:",-1)),e("span",Ue,a(f(parseFloat(s.value.toAmount),s.value.toCurrency)),1)]),e("div",Fe,[t[14]||(t[14]=e("span",null,"Tipo de cambio:",-1)),e("span",ke,a(N()),1)])])])):p("",!0),e("div",Te,[t[18]||(t[18]=e("h3",{class:"text-sm font-medium text-blue-900 mb-2"},"Tu saldo actual",-1)),e("div",je,[e("div",null,[t[16]||(t[16]=e("span",{class:"text-blue-700"},"Pesos:",-1)),e("span",Ee,a(f(((b=i(c).user)==null?void 0:b.userPesos)||0,"ARS")),1)]),e("div",null,[t[17]||(t[17]=e("span",{class:"text-blue-700"},"D贸lares:",-1)),e("span",Ie,a(f(((h=i(c).user)==null?void 0:h.userDolares)||0,"USD")),1)])])]),e("div",Pe,[A(m,{to:"/",class:"btn-secondary"},{default:K(()=>[...t[19]||(t[19]=[S(" Cancelar ",-1)])]),_:1}),e("button",{type:"submit",disabled:d.value||!w.value,class:"btn-primary"},[d.value?(u(),l("div",Me)):p("",!0),S(" "+a(d.value?"Procesando...":"Realizar Cambio"),1)],8,Ve)])],32)]),D.value.length>0?(u(),l("div",Ne,[e("div",ze,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Historial de cambios",-1)),e("div",Be,[(u(!0),l(Q,null,W(D.value.slice(0,5),n=>(u(),l("div",{key:n.transaccionesId,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",Le,[e("div",$e,[A(i(j),{class:"w-4 h-4 text-warning-600"})]),e("div",null,[t[20]||(t[20]=e("p",{class:"text-sm font-medium text-gray-900"},"Cambio de moneda",-1)),e("p",He,a(i(v).formatDate(n.transaccionesFecha)),1)])]),e("div",Oe,[n.transaccionesPesos!==0?(u(),l("div",qe,a(i(v).formatAmount(n.transaccionesPesos,"pesos")),1)):p("",!0),n.transaccionesDolares!==0?(u(),l("div",Ge,a(i(v).formatAmount(n.transaccionesDolares,"dolares")),1)):p("",!0)])]))),128))])])])):p("",!0)])}}});export{Ye as default};
