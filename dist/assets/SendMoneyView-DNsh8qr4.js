import{c as o,o as r,a as e,d as E,l as C,f as I,A as R,m as F,p as x,r as M,k as l,s as P,v as f,x as b,b as g,u as i,e as y,t as n,w as B,F as j,h as q}from"./index-DeSzD2_9.js";import{u as L}from"./transactions-DTEC-O-J.js";import{r as $}from"./ExclamationTriangleIcon-GKU9ARcA.js";import{r as z}from"./ArrowRightIcon-B2_2eJMI.js";function O(N,D){return r(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25"})])}const Z={class:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},G={class:"card"},H={class:"mb-6"},J={class:"relative"},K=["disabled"],Q={class:"absolute inset-y-0 right-0 pr-3 flex items-center"},W={class:"mb-6"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Y={class:"relative"},ee=["disabled"],se={class:"relative"},te=["disabled"],ae={key:0,class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},oe={class:"text-sm text-blue-800 space-y-1"},re={key:0},ne={key:1},le={class:"mb-6"},ie=["disabled"],de={key:1,class:"mb-6 p-4 bg-red-50 rounded-lg border border-red-200"},ue={class:"flex"},ce={class:"ml-3"},me={class:"mt-2 text-sm text-red-700"},pe={class:"list-disc list-inside mt-1"},ve={key:0},xe={key:1},fe={class:"mb-6 p-4 bg-gray-50 rounded-lg"},be={class:"grid grid-cols-2 gap-4 text-sm"},ge={class:"font-medium ml-2"},ye={class:"font-medium ml-2"},_e={class:"flex justify-end space-x-4"},he=["disabled"],Ae={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},De={key:0,class:"mt-8"},Se={class:"card"},ke={class:"space-y-3"},we={class:"flex items-center space-x-3"},Fe={class:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center"},Te={class:"text-xs text-gray-600"},Ne={class:"text-right"},Ue={key:0,class:"text-sm font-medium text-gray-900"},Ve={key:1,class:"text-sm font-medium text-gray-900"},T=1e3,Me=E({__name:"SendMoneyView",setup(N){const D=C(),v=I(),p=L(),U=R(),d=F(!1),t=F({recipientEmail:"",pesosAmount:"",dollarsAmount:"",description:""}),_=x(()=>{var m;const u=parseFloat(t.value.pesosAmount)||0,s=((m=v.user)==null?void 0:m.userPesos)||0;return Math.max(0,u-s)}),h=x(()=>{var m;const u=parseFloat(t.value.dollarsAmount)||0,s=((m=v.user)==null?void 0:m.userDolares)||0;return Math.max(0,u-s)}),A=x(()=>_.value===0&&h.value===0),S=x(()=>t.value.recipientEmail&&(parseFloat(t.value.pesosAmount)>0||parseFloat(t.value.dollarsAmount)>0)),c=(u,s)=>new Intl.NumberFormat("es-AR",{style:"currency",currency:s,minimumFractionDigits:0,maximumFractionDigits:2}).format(u),V=async()=>{var u;if(!(!A.value||!S.value))try{d.value=!0;const s={transaccionesUsuarioId:((u=v.user)==null?void 0:u.userId)||"",transaccionesPesos:parseFloat(t.value.pesosAmount)||0,transaccionesDolares:parseFloat(t.value.dollarsAmount)||0,transaccionesTipoId:3,transaccionesFecha:new Date().toISOString()};await p.createTransaction(s)&&(U.success("Transferencia enviada exitosamente"),D.push("/transactions"))}catch(s){console.error("Transfer error:",s)}finally{d.value=!1}};return(u,s)=>{var k,w;const m=M("router-link");return r(),o("div",Z,[s[20]||(s[20]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Enviar Dinero"),e("p",{class:"text-gray-600"}," Transfiere dinero a otro usuario de Dolarito de forma rápida y segura ")],-1)),e("div",G,[e("form",{onSubmit:P(V,["prevent"])},[e("div",H,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Destinatario ",-1)),e("div",J,[f(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.value.recipientEmail=a),type:"email",required:"",class:"input-field pr-10",placeholder:"Ingresa el email del destinatario",disabled:d.value},null,8,K),[[b,t.value.recipientEmail]]),e("div",Q,[g(i(O),{class:"h-5 w-5 text-gray-400"})])]),s[5]||(s[5]=e("p",{class:"mt-1 text-sm text-gray-600"}," El destinatario debe tener una cuenta en Dolarito ",-1))]),e("div",W,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Cantidad a enviar ",-1)),e("div",X,[e("div",null,[e("div",Y,[f(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.pesosAmount=a),type:"number",step:"0.01",min:"0",class:"input-field pr-16",placeholder:"0.00",disabled:d.value},null,8,ee),[[b,t.value.pesosAmount]]),s[6]||(s[6]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[e("span",{class:"text-gray-500 text-sm font-medium"},"ARS")],-1))])]),e("div",null,[e("div",se,[f(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>t.value.dollarsAmount=a),type:"number",step:"0.01",min:"0",class:"input-field pr-16",placeholder:"0.00",disabled:d.value},null,8,te),[[b,t.value.dollarsAmount]]),s[7]||(s[7]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[e("span",{class:"text-gray-500 text-sm font-medium"},"USD")],-1))])])]),s[9]||(s[9]=e("p",{class:"mt-1 text-sm text-gray-600"}," Puedes enviar en pesos argentinos, dólares, o ambos ",-1))]),parseFloat(t.value.pesosAmount)>0||parseFloat(t.value.dollarsAmount)>0?(r(),o("div",ae,[s[10]||(s[10]=e("h3",{class:"text-sm font-medium text-blue-900 mb-2"},"Información de conversión",-1)),e("div",oe,[parseFloat(t.value.pesosAmount)>0?(r(),o("div",re,[e("strong",null,n(c(parseFloat(t.value.pesosAmount)||0,"ARS")),1),y(" ≈ "+n(c((parseFloat(t.value.pesosAmount)||0)/T,"USD")),1)])):l("",!0),parseFloat(t.value.dollarsAmount)>0?(r(),o("div",ne,[e("strong",null,n(c(parseFloat(t.value.dollarsAmount)||0,"USD")),1),y(" ≈ "+n(c((parseFloat(t.value.dollarsAmount)||0)*T,"ARS")),1)])):l("",!0)])])):l("",!0),e("div",le,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Descripción (opcional) ",-1)),f(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=a=>t.value.description=a),rows:"3",class:"input-field",placeholder:"Agrega una descripción para esta transferencia...",disabled:d.value},null,8,ie),[[b,t.value.description]])]),A.value?l("",!0):(r(),o("div",de,[e("div",ue,[g(i($),{class:"h-5 w-5 text-red-400"}),e("div",ce,[s[13]||(s[13]=e("h3",{class:"text-sm font-medium text-red-800"},"Saldo insuficiente",-1)),e("div",me,[s[12]||(s[12]=e("p",null,"No tienes suficiente saldo para realizar esta transferencia:",-1)),e("ul",pe,[_.value>0?(r(),o("li",ve," Necesitas "+n(c(_.value,"ARS"))+" adicionales en pesos ",1)):l("",!0),h.value>0?(r(),o("li",xe," Necesitas "+n(c(h.value,"USD"))+" adicionales en dólares ",1)):l("",!0)])])])])])),e("div",fe,[s[16]||(s[16]=e("h3",{class:"text-sm font-medium text-gray-900 mb-2"},"Tu saldo actual",-1)),e("div",be,[e("div",null,[s[14]||(s[14]=e("span",{class:"text-gray-600"},"Pesos:",-1)),e("span",ge,n(c(((k=i(v).user)==null?void 0:k.userPesos)||0,"ARS")),1)]),e("div",null,[s[15]||(s[15]=e("span",{class:"text-gray-600"},"Dólares:",-1)),e("span",ye,n(c(((w=i(v).user)==null?void 0:w.userDolares)||0,"USD")),1)])])]),e("div",_e,[g(m,{to:"/",class:"btn-secondary"},{default:B(()=>[...s[17]||(s[17]=[y(" Cancelar ",-1)])]),_:1}),e("button",{type:"submit",disabled:d.value||!A.value||!S.value,class:"btn-primary"},[d.value?(r(),o("div",Ae)):l("",!0),y(" "+n(d.value?"Enviando...":"Enviar Dinero"),1)],8,he)])],32)]),i(p).recentTransactions.length>0?(r(),o("div",De,[e("div",Se,[s[19]||(s[19]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Transferencias recientes",-1)),e("div",ke,[(r(!0),o(j,null,q(i(p).recentTransactions.slice(0,3),a=>(r(),o("div",{key:a.transaccionesId,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",we,[e("div",Fe,[g(i(z),{class:"w-4 h-4 text-primary-600"})]),e("div",null,[s[18]||(s[18]=e("p",{class:"text-sm font-medium text-gray-900"},"Transferencia",-1)),e("p",Te,n(i(p).formatDate(a.transaccionesFecha)),1)])]),e("div",Ne,[a.transaccionesPesos!==0?(r(),o("div",Ue,n(i(p).formatAmount(a.transaccionesPesos,"pesos")),1)):l("",!0),a.transaccionesDolares!==0?(r(),o("div",Ve,n(i(p).formatAmount(a.transaccionesDolares,"dolares")),1)):l("",!0)])]))),128))])])])):l("",!0)])}}});export{Me as default};
